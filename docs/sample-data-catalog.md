# Sample Data Catalog (Azure Evidence Plane)

This catalog defines what sample data is allowed, where it is stored, and how it is handled.

## Storage Containers
Provisioned by Terraform in `infra/terraform/main.tf`:
- `samples-quarantine`: encrypted zipped malware samples (restricted access)
- `memory-captures`: memory dumps (`.raw`, `.lime`, `.mem`)
- `disk-images`: forensic images (`.E01`, `.dd`, `.raw`)
- `pcaps`: network captures (`.pcap`, `.pcapng`)
- `case-artifacts`: derived outputs (timeline, extracted IoCs, reports)
- `manifests`: SHA256 manifests for upload integrity
- `evidence`: general intake evidence

## Recommended Training/Test Data Sources
Start with non-malicious and public DFIR datasets first:
- Public memory and disk forensic corpora (e.g., educational datasets)
- Benign network captures and incident simulation data
- Internal synthetic incident data generated by your team

For malware binaries:
- Only store in `samples-quarantine`
- Use encrypted archives for storage/transfer where policy requires
- Require explicit approval and least-privilege access
- Never execute in non-isolated environments

## Data Handling Rules
1. Every upload must include SHA256 manifest in `manifests`.
2. No public blob/container access.
3. Access is RBAC-scoped to authorized security operations roles only.
4. Evidence is immutable once attached to a case (policy phase-in).
5. Malware samples must only be processed in isolated sandbox workers.

## Upload Workflow
Use script:
```bash
scripts/upload-sample-data.sh <resource-group> <storage-account> <container> <source-path>
```

Example:
```bash
scripts/upload-sample-data.sh \
  multiagent-dev-rg \
  <storage-account-name> \
  memory-captures \
  ./datasets/memory
```

## SIFT Integration Notes
- Mount/download sample blobs to ephemeral SIFT workers at job start.
- Keep workers single-case and destroy after analysis.
- Upload only derived artifacts and required evidence outputs.
- Maintain chain-of-custody metadata (case ID, source hash, operator ID).

## Release Validation (RV)
- Upload one file per container class and verify manifest integrity.
- Validate SIFT tools can read memory/disk/pcap samples.
- Validate malware samples are blocked outside sandbox path.
